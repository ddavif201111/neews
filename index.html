<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; user-select: none; touch-action: manipulation; }
        body { 
            background: #0d0d0d; color: white; margin: 0; font-family: sans-serif; 
            display: flex; flex-direction: column; height: 100vh; overflow: hidden;
        }
        .header { padding: 10px; background: #1a1a1a; text-align: center; border-bottom: 1px solid #333; }
        #balance { font-size: 34px; font-weight: bold; color: #ffdf00; margin: 5px 0; }
        
        .lvl-bar-bg { width: 60%; background: #333; height: 6px; border-radius: 10px; margin: 5px auto; overflow: hidden; }
        #lvl-fill { height: 100%; width: 0%; background: #00c6ff; }
        
        .page { display: none; flex: 1; flex-direction: column; align-items: center; width: 100%; position: relative; }
        .active { display: flex !important; }

        /* –¶–µ–Ω—Ç—Ä –∑ –ü–∞–Ω–¥–æ—é */
        #game-area { flex: 1; width: 100%; display: flex; align-items: center; justify-content: center; position: relative; }
        #coin { 
            width: 220px; height: 220px; background: radial-gradient(circle, #333, #000); 
            border: 6px solid #ffdf00; border-radius: 50%; display: flex; align-items: center; 
            justify-content: center; font-size: 90px; transition: transform 0.05s;
            pointer-events: none; /* –©–æ–± –∫–ª—ñ–∫ –ø—Ä–æ—Ö–æ–¥–∏–≤ –∫—Ä—ñ–∑—å –∫–∞—Ä—Ç–∏–Ω–∫—É –Ω–∞ —Ñ–æ–Ω */
        }

        /* –ù–∞–≤—ñ–≥–∞—Ü—ñ—è */
        .nav { height: 80px; display: flex; background: #1a1a1a; justify-content: center; align-items: center; gap: 15px; border-top: 1px solid #333; padding-bottom: 15px; }
        .nav-item { opacity: 0.4; font-size: 10px; text-align: center; width: 65px; cursor: pointer; padding: 10px; }
        .nav-item.active { opacity: 1; color: #0088cc; }
        .nav-item span { font-size: 22px; display: block; }

        .card { background: #1e1e1e; width: 90%; padding: 15px; border-radius: 15px; margin: 10px 0; display: flex; justify-content: space-between; align-items: center; border: 1px solid #444; }
        .btn { background: #0088cc; color: white; border: none; padding: 12px; border-radius: 10px; font-weight: bold; }
    </style>
</head>
<body>

<div class="header">
    <div id="lvl-txt" style="font-size: 12px; color: #888;">Baby Panda</div>
    <div class="lvl-bar-bg"><div id="lvl-fill"></div></div>
    <div id="balance">0</div>
</div>

<div id="pg-game" class="page active">
    <div id="game-area">
        <div id="coin">üêº</div>
    </div>
    <div style="width: 85%; margin-bottom: 20px;">
        <div style="display: flex; justify-content: space-between; font-size: 13px; margin-bottom: 5px;">
            <span>‚ö° <span id="energy">1000</span></span>
            <span>–ö–ª—ñ–∫: +<span id="pwr-val">1</span></span>
        </div>
        <div class="lvl-bar-bg" style="width: 100%; height: 8px;"><div id="en-bar" style="background: orange; width: 100%; height: 100%;"></div></div>
    </div>
</div>

<div id="pg-shop" class="page">
    <div class="card">
        <div><b>Multi-Tap</b><br><small>–¶—ñ–Ω–∞: <span id="p-price">50</span></small></div>
        <button class="btn" onclick="buyTap(event)">UPGRADE</button>
    </div>
</div>

<div id="pg-ref" class="page">
    <div class="card" style="flex-direction: column; text-align: center; gap: 15px;">
        <div style="font-size: 40px;">üéÅ</div>
        <div style="color:#ffdf00; font-weight:bold;">+2,500 –∑–∞ –∫–æ–∂–Ω–æ–≥–æ –¥—Ä—É–≥–∞!</div>
        <button class="btn" style="width: 100%; background: #d4af37; color: black;" onclick="inviteFriend(event)">–ó–ê–ü–†–û–°–ò–¢–ò</button>
    </div>
</div>

<div class="nav">
    <div class="nav-item active" onclick="showPage('pg-game', this)"><span>üöÄ</span>–ü—Ä–æ—î–∫—Ç</div>
    <div class="nav-item" onclick="showPage('pg-shop', this)"><span>üõí</span>–ú–∞–≥–∞–∑–∏–Ω</div><div class="nav-item" onclick="showPage('pg-ref', this)"><span>üë•</span>–î—Ä—É–∑—ñ</div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.ready(); tg.expand();

    let coins = Number(localStorage.getItem('c')) || 0;
    let xp = Number(localStorage.getItem('xp')) || 0;
    let pLvl = Number(localStorage.getItem('pl')) || 1;
    let energy = 1000;

    function update() {
        let lvl = xp < 1000 ? 1 : xp < 3000 ? 2 : xp < 6000 ? 3 : 4;
        const chars = ["üêº", "üê®", "üêª", "üêØ"];
        
        document.getElementById('balance').innerText = Math.floor(coins).toLocaleString();
        document.getElementById('energy').innerText = energy;
        document.getElementById('en-bar').style.width = (energy / 10) + '%';
        document.getElementById('coin').innerText = chars[lvl-1] || "üêØ";
        document.getElementById('pwr-val').innerText = pLvl;
        document.getElementById('p-price').innerText = Math.floor(50 * Math.pow(2, pLvl - 1));
        document.getElementById('lvl-fill').style.width = (xp % 1000 / 10) + '%';
        
        localStorage.setItem('c', coins);
        localStorage.setItem('xp', xp);
        localStorage.setItem('pl', pLvl);
    }

    // –ì–û–õ–û–í–ù–ò–ô –§–Ü–ö–°: –õ–æ–≤–∏–º–æ –∫–ª—ñ–∫ –ø–æ –≤—Å—ñ–π —ñ–≥—Ä–æ–≤—ñ–π –∑–æ–Ω—ñ
    document.getElementById('game-area').addEventListener('touchstart', function(e) {
        if (document.getElementById('pg-game').classList.contains('active')) {
            if (energy > 0) {
                coins += pLvl;
                xp += 1;
                energy -= 1;
                
                // –í—ñ–∑—É–∞–ª—å–Ω–∏–π –µ—Ñ–µ–∫—Ç
                const coinImg = document.getElementById('coin');
                coinImg.style.transform = 'scale(0.95)';
                setTimeout(() => coinImg.style.transform = 'scale(1)', 50);
                
                tg.HapticFeedback.impactOccurred('medium');
                update();
            }
        }
    });

    function showPage(id, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        el.classList.add('active');
        tg.HapticFeedback.impactOccurred('light');
    }

    function buyTap(e) {
        e.stopPropagation(); // –©–æ–± –∫–ª—ñ–∫ –ø–æ –∫–Ω–æ–ø—Ü—ñ –Ω–µ –∑–∞—Ä–∞—Ö—É–≤–∞–≤—Å—è —è–∫ —Ç–∞–ø –ø–æ –ø–∞–Ω–¥—ñ
        let price = Math.floor(50 * Math.pow(2, pLvl - 1));
        if (coins >= price) {
            coins -= price;
            pLvl += 1;
            update();
        }
    }

    function inviteFriend(e) {
        e.stopPropagation();
        const link = https://t.me/share/url?url=https://t.me/Clicker_teken_bot?start=ref&text=–ó–∞—Ö–æ–¥—å —É –º—ñ–π –ø—Ä–æ–µ–∫—Ç!;
        tg.openTelegramLink(link);
    }

    setInterval(() => { if (energy < 1000) { energy++; update(); } }, 1500);
    update();
</script>
</body>
</html>
